{"ast":null,"code":"var _jsxFileName = \"/home/durga/Sem_6/Web_Tech_2/Project/intra_mail/src/pages/Login.js\";\nimport React from \"react\";\nimport M from \"materialize-css\";\nimport { NavLink } from \"react-router-dom\";\n\nclass Login extends React.Component {\n  componentDidMount() {\n    // Auto initialize all the things!\n    M.AutoInit();\n    /*function check_login_state(){\n      var sender_object = {\n        xhr: new XMLHttpRequest(),\n        send:function(){\n          this.xhr.open(\"POST\",\"http://localhost:8080/users/login\",true);\n          this.xhr.onreadystatechange = this.callback;\n          this.xhr.withCredentials = true;\n          this.xhr.send();\n        },\n        callback:function(){\n          if (this.readyState == 4){\n            if (this.status == 202){\n              alert(\"You are already logged in\");\n              window.location.href = \"/home\";\n            }\n          }\n        }\n      }\n      sender_object.send();\n    }\n    check_login_state();*/\n  }\n\n  render() {\n    function attempt_login() {\n      var sender_object = {\n        xhr: new XMLHttpRequest(),\n        send: function () {\n          const data = {\n            user: document.getElementById(\"email\").value,\n            password: document.getElementById(\"password\").value\n          };\n          this.xhr.open(\"POST\", \"http://localhost:8080/users/login\", true);\n          this.xhr.onreadystatechange = this.callback;\n          this.xhr.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n          console.log(\"Sending login data\");\n          console.log(data);\n          this.xhr.send(JSON.stringify(data));\n        },\n        callback: function () {\n          if (this.readyState == 4) {\n            if (this.status == 200) {\n              alert(\"Successful login\");\n              let token = \"Bearer \" + JSON.parse(this.responseText).token;\n              localStorage.setItem('token', token);\n              var check = localStorage.getItem('token');\n\n              if (check) {\n                window.location.href = \"/home\";\n              } else {\n                window.location.href = \"/\";\n              }\n            }\n          }\n        }\n      };\n      sender_object.send();\n    }\n\n    function checkUser() {\n      console.log(\"Checking user\");\n      var sender_object = {\n        xhr: new XMLHttpRequest(),\n        send: function () {\n          this.xhr.open(\"GET\", \"http://localhost:8080/users/check?user=\" + document.getElementById(\"email\").value, true);\n          this.xhr.onreadystatechange = this.callback;\n          this.xhr.send();\n        },\n        callback: function () {\n          if (this.readyState === 4) {\n            const button = document.getElementById(\"login\");\n\n            if (this.status == 404) {\n              console.log(\"404\");\n              alert(\"User does not exist\");\n              button.disabled = \"true\";\n            }\n\n            if (this.status == 200) {\n              console.log(\"200\");\n              button.removeAttribute(\"disabled\");\n            }\n\n            if (this.status == 500) {\n              console.log(\"500\");\n              alert(\"server error\");\n            }\n          }\n        }\n      };\n      sender_object.send();\n    }\n\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"main\", {\n      className: \"col s2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col s12 m3 offset-m3 card center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }, \"Login\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col s12 m3 offset-m0 card center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h5\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      to: \"/signup\",\n      exact: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, \"Signup\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col s12 m6 offset-m3 card center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field col s12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: \"validate\",\n      type: \"text\",\n      name: \"email\",\n      id: \"email\",\n      onBlur: checkUser,\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      for: \"email\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }\n    }, \"Username\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field col s12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      className: \"validate\",\n      type: \"password\",\n      name: \"password\",\n      id: \"password\",\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      for: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }\n    }, \"Password\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      id: \"login\",\n      className: \"btn btn-small blue waves-effect\",\n      onClick: attempt_login,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 15\n      }\n    }, \"Login\"))))));\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["/home/durga/Sem_6/Web_Tech_2/Project/intra_mail/src/pages/Login.js"],"names":["React","M","NavLink","Login","Component","componentDidMount","AutoInit","render","attempt_login","sender_object","xhr","XMLHttpRequest","send","data","user","document","getElementById","value","password","open","onreadystatechange","callback","setRequestHeader","console","log","JSON","stringify","readyState","status","alert","token","parse","responseText","localStorage","setItem","check","getItem","window","location","href","checkUser","button","disabled","removeAttribute"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport M from \"materialize-css\";\nimport { NavLink } from \"react-router-dom\";\n\nclass Login extends React.Component {\n  componentDidMount() {\n    // Auto initialize all the things!\n    M.AutoInit();\n    /*function check_login_state(){\n      var sender_object = {\n        xhr: new XMLHttpRequest(),\n        send:function(){\n          this.xhr.open(\"POST\",\"http://localhost:8080/users/login\",true);\n          this.xhr.onreadystatechange = this.callback;\n          this.xhr.withCredentials = true;\n          this.xhr.send();\n        },\n        callback:function(){\n          if (this.readyState == 4){\n            if (this.status == 202){\n              alert(\"You are already logged in\");\n              window.location.href = \"/home\";\n            }\n          }\n        }\n      }\n      sender_object.send();\n    }\n    check_login_state();*/\n  }\n  render() {\n    function attempt_login(){\n      var sender_object = {\n        xhr: new XMLHttpRequest(),\n        send:function(){\n          const data = {\n            user: document.getElementById(\"email\").value,\n            password: document.getElementById(\"password\").value\n          };\n          this.xhr.open(\"POST\",\"http://localhost:8080/users/login\",true);\n          this.xhr.onreadystatechange = this.callback;\n          this.xhr.setRequestHeader(\"Content-Type\", \"application/json;charset=UTF-8\");\n          console.log(\"Sending login data\");\n          console.log(data);\n          this.xhr.send(JSON.stringify(data));\n        },\n        callback:function(){\n          if (this.readyState == 4){\n            if (this.status == 200){\n              alert(\"Successful login\");\n              let token = \"Bearer \" + JSON.parse(this.responseText).token;\n              localStorage.setItem('token',token);\n              var check = localStorage.getItem('token');\n              if (check) {\n                window.location.href = \"/home\";\n              }\n              else {\n                window.location.href = \"/\"\n              }\n            }\n          }\n        }\n      }\n      sender_object.send();\n    }\n\n    function checkUser(){\n      console.log(\"Checking user\");\n      var sender_object = {\n        xhr: new XMLHttpRequest(),\n        send:function(){\n          this.xhr.open(\"GET\",\"http://localhost:8080/users/check?user=\"+document.getElementById(\"email\").value,true);\n          this.xhr.onreadystatechange = this.callback;        \n          this.xhr.send();\n        },\n        callback:function(){\n          if (this.readyState === 4){\n              const button = document.getElementById(\"login\");\n              if(this.status == 404){\n                console.log(\"404\");\n                alert(\"User does not exist\");\n                button.disabled = \"true\";\n              }\n              if(this.status == 200){\n                console.log(\"200\");\n                button.removeAttribute(\"disabled\");                \n              }\n              if(this.status == 500){\n                console.log(\"500\");\n                alert(\"server error\");\n              }\n          }\n        }\n      }\n      sender_object.send()\n    }\n\n    return (\n      <>\n        <main className=\"col s2\">\n            <div className=\"row\">\n            <div className=\"col s12 m3 offset-m3 card center\">\n                <h5>Login</h5>\n                </div>\n                <div className=\"col s12 m3 offset-m0 card center\">\n                <h5>\n                    <NavLink to=\"/signup\" exact>\n                    Signup\n                  </NavLink>\n                  </h5>\n                </div>\n            <div className=\"col s12 m6 offset-m3 card center\">\n              <div className=\"input-field col s12\">\n                <input className=\"validate\" type=\"text\" name=\"email\" id=\"email\" onBlur={checkUser} required />\n                <label for=\"email\">Username</label>\n              </div>\n\n              <div className=\"input-field col s12\">\n                <input className=\"validate\" type=\"password\" name=\"password\" id=\"password\" required />\n                <label for=\"password\">Password</label>\n              </div>\n              <div>\n              <button id=\"login\" className=\"btn btn-small blue waves-effect\" onClick={attempt_login}>\n                Login\n              </button>\n              </div>\n            </div>\n          </div>\n        </main>\n      </>\n    );\n  }\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}